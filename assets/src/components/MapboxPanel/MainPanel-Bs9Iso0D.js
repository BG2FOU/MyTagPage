import{V as W}from"../ElementComponent/VueDatePicker-ByrbP6QH.js";import{E as X}from"../ElementComponent/ElementDateTimePicker-BOxdlPWT.js";import{_ as ae}from"../DataProcess/DataHandler-BdsYUxZ9.js";import{_ as oe}from"../localStorage-DI3hWFE7.js";import{S as ne}from"../DataProcess/ServerAddr-2Ip0eJ59.js";import{u as se}from"./stores/deviceStore-C0BIN_ip.js";import{r as i,g as k,f as ie,b as de,w as $,C as re,i as d,D as ue,d as w,o as u,k as s,e as l,a as g,j as t,l as p,z as me,t as fe,G as pe,F as A,s as ce,p as ve}from"../../../vendor-UN2rW63P.js";import{_ as _e}from"../../../plugin-vue_export-helper-DlAUqK2U.js";const ge={class:"main-layout-wrapper"},ye={class:"main-layout"},ke={key:0},we={class:"flex-center"},Ve={class:"flex flex-wrap gap-4"},xe={class:"flex"},be={__name:"MainPanel",props:{loading:{type:Boolean,default:!1}},emits:["submit","addHeatMap","realtime","exportGPX"],setup(B,{emit:E}){const h=se().propsMap,V=i(!1);i("btt");const r=i([]),x=i({}),H=i(null),F=i({}),b=i(!1),D=i(""),c=i(null),y=i([]),v=k(()=>{const m=[];for(const e of y.value){const n=h[e];n&&n.privateKey&&m.push(n.privateKey)}return m.flat()}),a=ie({idSelected:[],dateTimeRange:{start:"",end:""},mode:""}),I=B,N=k(()=>I.loading),S=i(window.innerWidth),R=()=>{S.value=window.innerWidth},_=E,z=k(()=>S.value<=770?"90%":"fit-content"),P=k(()=>S.value<=770),T=()=>{a.idSelected=v.value,a.idSelected.length>0&&Array.from(a.dateTimeRange).length>1&&(c.value="track",_("submit",a))},M=()=>{a.idSelected=v.value,a.idSelected.length>0&&Array.from(a.dateTimeRange).length>1&&(c.value="heatmap",_("addHeatMap",a))},G=()=>{a.idSelected=v.value,a.idSelected.length>0&&(c.value="realtime",_("realtime",a))},L=()=>{a.idSelected=[],y.value=[]},j=()=>{a.idSelected=v.value,a.idSelected.length>0&&Array.from(a.dateTimeRange).length>1&&_("exportFullGPX",a)},K=()=>{a.idSelected=v.value,a.idSelected.length>0&&Array.from(a.dateTimeRange).length>1&&_("exportWaypointsGPX",a)};return de(()=>{window.addEventListener("resize",R),a.dateTimeRange=r.value,$(()=>r.value,m=>{a.dateTimeRange=m,x.value=m,c.value==="track"?T():c.value==="heatmap"?M():c.value==="realtime"&&G()},{deep:!0}),$(()=>a,m=>{x.value=m},{deep:!0})}),re(()=>{window.removeEventListener("resize",R)}),(m,e)=>{const n=d("el-button"),q=d("el-option"),J=d("el-select"),f=d("el-col"),O=d("CircleClose"),Q=d("el-icon"),U=d("el-row"),C=d("el-form-item"),Y=d("el-form"),Z=d("el-card"),ee=d("el-dialog"),le=ue("loading");return u(),w(A,null,[s("div",ge,[s("div",ye,[P.value?(u(),g(W,{key:1,modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value=o),range:""},null,8,["modelValue"])):(u(),g(X,{key:0,modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o)},null,8,["modelValue"]))]),l(n,{class:"dialog-button",type:"primary",onClick:e[2]||(e[2]=o=>V.value=!0)},{default:t(()=>e[9]||(e[9]=[s("i",{class:"fa-solid fa-list",style:{"margin-right":"10px"}},null,-1),p("数据选择 ")])),_:1,__:[9]}),l(ae,{payload:x.value,ref_key:"DataHandlerRef",ref:H},null,8,["payload"]),l(oe,{data:F.value},null,8,["data"])]),s("div",null,[l(n,{type:"info",round:"",class:"server-config",onClick:e[3]||(e[3]=o=>b.value=!0)},{default:t(()=>e[10]||(e[10]=[p("配置服务器")])),_:1,__:[10]}),D.value?(u(),w("p",ke,"当前服务器地址："+fe(D.value),1)):me("",!0),l(ne,{isVisible:b.value,onClose:e[4]||(e[4]=o=>b.value=!1)},null,8,["isVisible"])]),l(ee,{modelValue:V.value,"onUpdate:modelValue":e[8]||(e[8]=o=>V.value=o),title:"数据选择",width:z.value,draggable:"","align-center":""},{default:t(()=>[s("div",we,[pe((u(),w("div",Ve,[l(Z,{class:"card",shadow:"never",style:{"max-width":"600px"}},{default:t(()=>[l(Y,{model:a,"label-width":"auto"},{default:t(()=>[l(C,{label:"物品选择"},{default:t(()=>[l(U,{gutter:10},{default:t(()=>[l(f,{span:19},{default:t(()=>[l(J,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=o=>y.value=o),multiple:"",filterable:"","default-first-option":"","reserve-keyword":!1,placeholder:"选择物品",style:{"min-width":"150px"}},{default:t(()=>[(u(!0),w(A,null,ce(ve(h),(o,te)=>(u(),g(q,{key:te,label:`${o.emoji} ${o.name}`,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{span:5},{default:t(()=>[l(n,{onClick:L,type:"primary"},{default:t(()=>[l(Q,{style:{"vertical-align":"middle"}},{default:t(()=>[l(O)]),_:1}),e[11]||(e[11]=s("span",{class:"hide-small",style:{"vertical-align":"middle"}},"清除选择",-1))]),_:1,__:[11]})]),_:1})]),_:1})]),_:1}),l(C,{label:"时间段",style:{"max-width":"600px"}},{default:t(()=>[l(f,{span:24},{default:t(()=>[P.value?(u(),g(W,{key:1,modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value=o),range:""},null,8,["modelValue"])):(u(),g(X,{key:0,modelValue:r.value,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value=o)},null,8,["modelValue"]))]),_:1})]),_:1}),l(C,null,{default:t(()=>[s("div",xe,[l(U,{gutter:20},{default:t(()=>[l(f,{xs:12,sm:8,md:6},{default:t(()=>[l(n,{class:"el-button-grid",type:"primary",onClick:T},{default:t(()=>e[12]||(e[12]=[s("i",{class:"fa-regular fa-square-check hide-small margin-right"},null,-1),p("轨迹点 ")])),_:1,__:[12]})]),_:1}),l(f,{xs:12,sm:8,md:6},{default:t(()=>[l(n,{class:"el-button-grid",type:"primary",onClick:M},{default:t(()=>e[13]||(e[13]=[s("i",{class:"fa-solid fa-fire hide-small margin-right"},null,-1),p("热力图 ")])),_:1,__:[13]})]),_:1}),l(f,{xs:12,sm:8,md:6},{default:t(()=>[l(n,{class:"el-button-grid",type:"primary",onClick:G},{default:t(()=>e[14]||(e[14]=[s("i",{class:"fa-regular fa-clock hide-small margin-right"},null,-1),p("最新位置 ")])),_:1,__:[14]})]),_:1}),l(f,{xs:16,sm:15,md:8},{default:t(()=>[l(n,{class:"el-button-grid",type:"primary",onClick:K},{default:t(()=>e[15]||(e[15]=[s("i",{class:"fa-regular fa-file hide-small margin-right"},null,-1),p("导出GPX(仅航点) ")])),_:1,__:[15]})]),_:1}),l(f,{xs:16,sm:15,md:8},{default:t(()=>[l(n,{class:"el-button-grid",type:"primary",onClick:j},{default:t(()=>e[16]||(e[16]=[s("i",{class:"fa-regular fa-file hide-small margin-right"},null,-1),p("导出完整GPX(含轨迹) ")])),_:1,__:[16]})]),_:1})]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1})])),[[le,N.value]])])]),_:1},8,["modelValue","width"])],64)}}},Ue=_e(be,[["__scopeId","data-v-3e3ea137"]]);export{Ue as M};
